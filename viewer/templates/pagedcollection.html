% extends "thing.html"

{% block title %}${ui.SEARCH_RESULTS.label}{% endblock %}

% macro search_controls()

<div class="col-md-3 hidden-xs hidden-sm">
  <ul class="list-group facet-controls">
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
  </ul>
</div>

<div class="col-md-9">
  <div class="panel panel-default search-controls">
    
    <form action="/find" method="GET">
      <label class="type-label">
        Välj typ
      </label>
      <div class="btn-group type-buttons" data-toggle="buttons" role="group" aria-label="Välj typ">
        <label class="btn btn-default no-choice">
          <input name="type" value="" type="radio">Alla
        </label>
      % for type in types
        <label class="btn btn-default">
          <input name="type" value="${type}" type="radio">${type}
        </label>
      % endfor
      </div>
      
      <div class="form-inline">
        <div class="form-group search-input">
          % for param, values in parse_qs(request.query_string).items()
              % if param != 'q'
                  % for value in values
                      <input type="hidden" name="${param}" value="${value}" />
                  % endfor
              % endif
          % endfor
          <label class="search-label" id="searchlabel" for="q">
            Sök term
          </label>
          <input aria-labelledby="searchlabel" class="form-control search-input" name="q" id="q" value="${thing.textQuery}" />
          <button class="search-button btn btn-primary"><i class="fa fa-search"></i> Sök</button>
        </div>
      </div>
    </form>
</div>
</div>
<div class="col-md-12 hidden-md hidden-lg">
  <ul class="list-group facet-controls">
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
    <li class="list-group-item">Facet</li>
  </ul>
</div>
% endmacro

% macro result_controls(details)
  <div class="panel panel-default result-controls">
    % if details
    <div class="search-details">
      <span class="search-keyword">
        % if thing.textQuery and len(thing['items']) > 0
          Sökning på <i>"${thing.textQuery}"</i>
          % if len(thing['items'])
            gav ${len(thing['items'])} träffar.
          % endif
        % elif thing.value
          Sökning ${thing.value}
        % else
          Sökning på <i>"${thing.textQuery}"</i> gav inga träffar.
        % endif
      </span>
      <span class="search-items-per-page pull-right">
        % if thing.totalItems
        Visar resultat
          ${thing.itemOffset + 1}-${min(thing.totalItems, thing.itemOffset + len(thing['items']))}.
        % endif
      </span>
    </div>
    % endif
    
    <div class="search-buttons">
      % if thing.first and thing.previous
      <a class="btn btn-primary pagination-firstpage" href="${thing.firstPage[ID]}">Första</a>
      % else
      <a class="btn btn-primary pagination-firstpage" disabled>Första</a>
      % endif
      % if thing.previous
      <a class="btn btn-primary pagination-back" href="${thing.previousPage[ID]}">Föregående</a>
      % else
      <a class="btn btn-primary pagination-back" disabled>Föregående</a>
      % endif
      % if thing.next
      <a class="btn btn-primary pagination-next" href="${thing.nextPage[ID]}">Nästa</a>
      % else
      <a class="btn btn-primary pagination-next" disabled>Nästa</a>
      % endif
    </div>
  </div>
% endmacro

% block content
  % set items = thing['items']
<div class="row">
  
  ${ search_controls() }
  
  <div class="col-md-9">    
    ${ result_controls(True) }
    % if items
    % for item in items
      ${viewthing(item, classes='panel panel-default hit-item', rel='items')}
    % endfor
      ${ result_controls(False) }
    % else

    % endif
  </div>
</div>
% endblock
