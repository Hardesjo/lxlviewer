{% extends "base.html" %}

{% block bodyattrs %}id="createnew"{% endblock %}

% block content
{% if current_user.is_authenticated %}

  <div id="app">
  <h1>Skapa ny</h1>
  <div class="panel panel-default">
    <div class="panel-body container-fluid choice-container dash green">
      <div class="row">
        <a v-for="choice in choices" class="choice" v-on:click="selectedChoice = choice.trigger">
          <div class="col-lg-4">
            <span class="circle"><i class="icon fa fa-{{choice.icon}}" aria-hidden="true"></i></span>
            <h2>{{choice.title}}</h2>
            <p>{{choice.text}}</p>
          </div>
        </a>
      </div>
    </div>
  </div>

      <!-- Import form -->
    <div v-show="selectedChoice == 'import'" class="panel panel-default form-container" id="import_post">
      <div class="panel-body container-fluid">
      <div class="row">
          <form>
          <div class="col-md-6">
            <div class="form-group">
              <label for="source">KÄLLA</label>
              <select v-show="databases.state == 'complete'" class="form-control" id="source">
                <option v-for="db in databases.list" track-by="$index">{{db.name}} ({{db.country}})</option>
              </select>
              <p v-show="databases.state == 'loading'"><i class="fa fa-cog fa-spin"></i> Laddar externa databaser...</p>
              <p v-show="databases.state == 'error'"><i class="fa fa-close"></i> Kunde inte hämta externa databaser. <a href="" v-on:click.prevent="loadRemoteDatabases()">Försök igen</a></p>
            </div>
          </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="search">SÖK</label>
                <input type="text" class="form-control" placeholder="Titel, författare, isbn..." id="search">
              </div>
              <button id="searchSubmit" class="search-button btn btn-primary"><i class="fa fa-search"></i> Sök</button>
            </div>
          </form>
        </div>
      </div>
    </div>

      <!-- Copy form -->
    <div v-show="selectedChoice == 'copy'" class="panel panel-default form-container" id="copy_post">
      <div class="panel-body container-fluid">
        <div class="row">
          <div class="col-md-12">
          <label>HÄMTA</label>
            <input value="@id"></input>
          </div>
        </div>
      </div>
    </div>

      <!-- Create new form -->
    <div v-show="selectedChoice == 'from_material'" class="panel panel-default form-container" id="create_new_post">
      <div class="panel-body container-fluid">
        <div class="row">
          <form>
            <div class="col-md-4" v-for="(index, materialList) in materialLists" track-by="$index">
              <h2>{{materialList.id | labelByLang}}</h2>
              <div class="radio" v-for="material in materialList.list">
                <label v-on:click="setMaterial(index, material['@id'])">
                  <input name="{{materialList.id}}" type="radio" value="{{material['@id']}}">{{material['@id'] | labelByLang}}</input>
                </label>
              </div>
            </div>
            <div class="col-md-4 submitter">
              <button v-bind:disabled="!hasChosenMaterials" @click.prevent="createNew()">Skapa post</button>
            </div>
          </form>
        </div>
      </div>
    </div>

  </div>
  {% else %}
  <p>Du måste logga in.</p>
  {% endif %}
% endblock
